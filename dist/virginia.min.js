define("virginia/common",[],function(){var e={escape_html:function(e){return e?e.replace(/[&<"']/g,function(e){switch(e){case"&":return"&amp;";case"<":return"&lt;";case'"':return"&quot;";default:return"&#039;"}}):e},break_lines:function(e){return e?e.replace(/(?:\r\n|\r|\n)/g,"<br />"):e},money:function(e,t){var n=Math.abs(e).toFixed(3).replace(/\d$/,"");return t.thousands_separator&&(n=n.replace(/(\d)(?=(\d{3})+(\.|$))/g,"$1"+t.thousands_separator)),t.currency&&("left"===t.currency_position?n=t.currency+n:n+=t.currency),e<0&&(n="-"+n),n}};return e}),define("virginia/templates",["virginia/common"],function(e){var t={_html_cache:{},_templates_cache:{},_global_context:{},get:function(e){if(t._templates_cache.hasOwnProperty(e)){var n=t._templates_cache[e],i=t._html_cache[e],r=$.Deferred();return setTimeout(function(){r.resolve(n,i)},1),r.promise()}var o=$.Deferred(function(n){$.get(e).done(function(i){t.process_tags(i).done(function(i){var r=Handlebars.compile(i);t._html_cache[e]=i,t._templates_cache[e]=r,n.resolve(r,i)})}).fail(function(){throw new Error("Could not load template "+e)})});return o.promise()},preload:function(){var e=[];if(arguments.length>0)for(var n=0;n<arguments.length;n++){var i=arguments[n];e.push(t.get(i))}return $.when.apply($,e)},render:function(e,n){var i=$.extend({},t._global_context,n);return e(i)},add_to_global_context:function(e){t._global_context=$.extend(t._global_context,e)},_re_include:/\{\{include\s+'([^']+)'\s*\}\}/i,process_tags:function(e){var n=t._re_include.exec(e);if(n){var i=n[0],r=n[1].replace(/\\/g,"/"),o=t._template_url(r),a=$.Deferred(function(n){t.get(o).done(function(n,r){e=e.replace(i,r),t.process_tags(e).done(function(e){a.resolve(e)})})});return a.promise()}return $.Deferred().resolve(e).promise()},_template_url:function(e){return e},helpers:{raw:function(e){return new Handlebars.SafeString(e)},escape:function(e){return encodeURI(e)},unescape:function(e){return decodeURI(e)},eq:function(e,t,n){return e==t?n.fn(this):n.inverse(this)},noeq:function(e,t,n){return e!=t?n.fn(this):n.inverse(this)},break_lines:function(t){return new Handlebars.SafeString(e.break_lines(e.escape_html(t)))},condition:function(e,t,n,i){var r=!1;switch(t){case"==":r=e==n;break;case"!=":r=e!=n;break;case">=":case"gte":r=e>=n;break;case">":case"gt":r=e>n;break;case"<=":case"lte":r=e<=n;break;case"<":case"lt":r=e<n;break;default:console.error('condition hb tag: unexpected operator "'+t+'".'),r=!1}return r?i.fn(this):i.inverse(this)},moment:function(e,t){if(!e)throw"Date in not defined for 'moment' Handlebars helper!";if(!window.moment)throw"moment hb helper: moment.js lib is not loaded";var n=new Date(e);return moment(n).format(t)},moment_humanize_duration:function(e,t){if(!e)throw"Date in not defined for 'moment_duration' Handlebars helper!";if(!window.moment)throw"moment hb helper: moment.js lib is not loaded";return e="number"==typeof e?e:parseInt(e),moment.duration(e,t).humanize()},money:function(t,n,i){return null!=t?t.indexOf&&t.indexOf(".")>=0&&(t=t.replace(/,/g,"")):t=0,e.money(parseFloat(t),{currency:"string"==typeof n?n:"$",currency_position:"string"==typeof i?i:"left"})}},register_helpers:function(){_.each(this.helpers,function(e,t){Handlebars.registerHelper(e,t)})},init:function(){this.register_helpers()}};return t}),define("virginia/view",["virginia/templates"],function(e){var t=Backbone.View.extend({template_name:"please set path to template path",after_initialize:function(){},render:function(e){var t=this;return this._rendered=!1,this.load_template(this.template_name).done(function(e){t._render_template(e)}),this},load_template:function(t){return e.get(t)},_render_template:function(e){var t=this.get_context(),n=this._process_template(e,t);this.template=e,this.$el.html(n),this.delegateEvents(),this.after_render(),this._rendered=!0,this.trigger("rendered")},_process_template:function(t,n){var i=e.render(t,n);return i},html_render:function(e){return this.template(e)},is_rendered:function(){return this._rendered||!1},get_context:function(){return{}},after_render:function(){},focus:function(){this.$("input:first").focus()},bind_selectors:function(){var e=_.result(this,"base_selectors",{}),t=_.result(this,"selectors",{}),n=_.extend({},e,t);for(var i in n)n.hasOwnProperty(i)&&(this["$"+i]=this.$(n[i]))},show:function(){this.$el.show()},hide:function(){this.$el.hide()},clear:function(){this.undelegateEvents(),this.stopListening(),this.$el&&this.$el.length>0&&this.$el.empty(),this.trigger("destroy")}});return t}),define("virginia/model-view",["virginia/view"],function(e){var t=e.extend({initialize:function(e){this.options=e,this.fetch_model=!1,this.create_model(e),this.fetch_and_render(),this.after_initialize()},create_model:function(e){if(!this.model){if(!e.model_id)throw"Virginia.BaseModelView needs model or model_id";var t=e.model_class||this.model_class;if(!t)throw"Virginia.BaseModelView needs model_class";var n=t.prototype.idAttribute,i={};i[n]=e.model_id,this.model=new t(i,e.model_options||{}),this.fetch_model=!0}},fetch_and_render:function(){this.fetch_model?(this.model.fetch().done(function(){this.render()}.bind(this)),this.fetch_model=!1):this.render()},get_context:function(){return{model:this.model.toJSON()}}});return t}),define("virginia/collection-view",["virginia/view"],function(e){return BaseCollectionView=e.extend({initialize:function(e){if(this.options=e,this.collection)this.render();else{var t=e.collection_class||this.collection_class;if(!t)throw"Virginia.BaseCollectionView.initialize needs collection_class";this.collection=new t([],e.collection_options||{}),this.fetch_and_render()}this.after_initialize()},fetch_and_render:function(){this.collection.fetch().done(function(){this.render()}.bind(this))},get_context:function(){return{collection:this.collection.toJSON()}}}),BaseCollectionView}),define("virginia",["virginia/templates","virginia/view","virginia/model-view","virginia/collection-view","virginia/common"],function(e,t,n,i,r){"use strict";var o={Templates:e,BaseView:t,BaseModelView:n,BaseCollectionView:i,Common:r};return o.Templates.init(),o});